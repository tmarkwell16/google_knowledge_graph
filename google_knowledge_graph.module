<?php

/**
*	@file
* Generate JSON-LD code for Google Knowledge Graph.
**/

// =================================
// = Implements hook_permission(). =
// =================================

function google_knowledge_graph_permission() {
	$permission = array(
		'administer google kg' => array(
			'title' => t('Administer Google Knowledge Graph'),
			'description' => t('Configure Google Knowledge Graph settings.'),
		),
	);
	return $permission;
}

// ===========================
// = Implements hook_menu(). =
// ===========================

function google_knowledge_graph_menu() {
	$items = array();
	
	$items['admin/config/system/googlekg'] = array(
		'title' => t('Google Knowledge Graph Settings'),
		'description' => t('Google Knowledge Graph Settings'),
		'page callback' => 'drupal_get_form',
		'page arguments' => array('google_knowledge_graph_admin_settings'),
		'access arguments' => array('administer google kg'),
	);
	return $items;
}

// =================================
// = Construct admin settings form =
// =================================

function google_knowledge_graph_admin_settings() {
	$form['description'] = array(
		'#type' => 'item',
		'#title' => t('Provide the information below for your company. 
			Your Knowledge Graph information will be generated from this information.'),
	);
	$form['company_info'] = array(
		'#type' => 'fieldset',
		'#title' => t('Company Information'),
		'#collapsible' => TRUE,
		'#collapse' => FALSE,
	);
	$form['company_info']['co_name'] = array(
		'#type' => 'textfield',
		'#title' => t('Company Name'),
		'#default_value' => variable_get('co_name', ''),
		'#size' => 60,
		'#maxlength' => 128,
		'#required' => TRUE,
	);
	$form['submit'] = array(
		'#type' => 'submit',
		'#value' => 'Save Configuration',
	);
	return $form;
}

// =============================================================
// = Submit callback for google_knowledge_graph_admin_settings =
// =============================================================

function google_knowledge_graph_admin_settings_submit($form, &$form_state) {
	variable_set('co_name', $form_state['values']['co_name']);
	drupal_set_message(t('Configuration settings have been saved'));
}